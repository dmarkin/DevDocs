XMLHttpRequest: кросс-доменные запросы
Спецификация CORS налагает специальные ограничения на запросы. Запросы в ней делятся на два вида.

Простыми считаются запросы, если они удовлетворяют следующим двум условиям:

Простой метод: GET, POST или HEAD
Простые заголовки – только из списка:
Accept
Accept-Language
Content-Language
Content-Type со значением application/x-www-form-urlencoded, multipart/form-data или text/plain.

В кросс-доменный запрос браузер автоматически добавляет заголовок Origin, содержащий домен, с которого осуществлён запрос.
[Origin нужен, потому что Referer передаётся не всегда. В частности, при запросе с HTTPS на HTTP – нет Referer.
 Политика Content Security Policy может запрещать пересылку Referer. По стандарту. Referer является необязательным HTTP-заголовком,
   в некоторых браузерах есть настройки, которые запрещают его слать.
 Именно поэтому, ввиду того, что на Referer полагаться нельзя, и придумали заголовок Origin, который гарантированно присылается при кросс-доменных запросах.]

Сервер должен, со своей стороны, ответить специальными заголовками, разрешает ли он такой запрос к себе.
Если сервер разрешает кросс-доменный запрос с этого домена – он должен добавить к ответу заголовок Access-Control-Allow-Origin,
 содержащий домен запроса или звёздочку *.
Если Access-Control-Allow-Origin нет, то браузер считает, что разрешение не получено, и завершает запрос с ошибкой.
При таких запросах не передаются куки и заголовки HTTP-авторизации.
Чтобы браузер передал вместе с запросом куки и HTTP-авторизацию, нужно:
var xhr = new XMLHttpRequest();
xhr.withCredentials = true;

Для запросов с withCredentials предусмотрено дополнительное подтверждение со стороны сервера - он должен вернуть два заголовка:
Access-Control-Allow-Origin: домен // * не используется!
Access-Control-Allow-Credentials: true


Чтобы JavaScript мог прочитать HTTP-заголовок ответа, сервер должен указать его имя в Access-Control-Expose-Headers ответа.
По умолчанию скрипт может прочитать из ответа только «простые» заголовки:
Cache-Control
Content-Language
Content-Type
Expires
Last-Modified
Pragma


«Непростыми» считаются все остальные, например, запрос с методом PUT или с заголовком Authorization не подходит под ограничения выше.
В этом случае используется дополнительный preflight-запрос с методом OPTIONS.
Он не содержит тела и содержит название желаемого метода в заголовке Access-Control-Request-Method,
 а если добавлены особые заголовки, то и их тоже – в Access-Control-Request-Headers.
Его задача – спросить сервер, разрешает ли он использовать выбранный метод и заголовки.
На этот запрос сервер должен ответить статусом 200, без тела ответа, указав заголовки Access-Control-Allow-Methods: метод и,
 при необходимости, Access-Control-Allow-Headers: разрешённые заголовки.

Дополнительно он может указать Access-Control-Max-Age: sec, где sec – количество секунд, на которые нужно закэшировать разрешение.
 Тогда при последующих вызовах метода браузер уже не будет делать предзапрос.